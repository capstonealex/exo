<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Alex Exoskeleton: /Users/williamcampbell/Documents/GitHub/exo/ALEX/src/CANopenNode/stack/socketCAN/CO_Linux_tasks.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Alex Exoskeleton
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d8e9d018ee741553d096b4f0e1f9077a.html">ALEX</a></li><li class="navelem"><a class="el" href="dir_2a5b9178e96b436cc002d189eae76bce.html">src</a></li><li class="navelem"><a class="el" href="dir_6868c45658fec6388c3fa4862a4ac13a.html">CANopenNode</a></li><li class="navelem"><a class="el" href="dir_b5f0e13f844f0a6988ab0ad014615937.html">stack</a></li><li class="navelem"><a class="el" href="dir_82e1e27adcd741fc4da6a9e692acf501.html">socketCAN</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">CO_Linux_tasks.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a href="_c_o___linux__tasks_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a3fcc21d39338b63a6e67344c57f75ec7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_c_o___linux__tasks_8h.html#a3fcc21d39338b63a6e67344c57f75ec7">taskMain_init</a> (int fdEpoll, uint16_t *<a class="el" href="_c_o___linux__tasks_8c.html#ac23667425f53852f06b73af3b480e138">maxTime</a>)</td></tr>
<tr class="separator:a3fcc21d39338b63a6e67344c57f75ec7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d70d277400050a2e10a0e6ce0e2a15e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_c_o___linux__tasks_8h.html#a1d70d277400050a2e10a0e6ce0e2a15e">taskMain_close</a> (void)</td></tr>
<tr class="separator:a1d70d277400050a2e10a0e6ce0e2a15e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a747f27c60b64040104d511f4a18a4ca9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_c_o__driver_8h.html#a9d1c1dc81799d49e2348821d6a8cac63">bool_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_c_o___linux__tasks_8h.html#a747f27c60b64040104d511f4a18a4ca9">taskMain_process</a> (int fd, <a class="el" href="group___c_o___n_m_t___heartbeat.html#gaf42f056a571b8e17a2d74428d1a49674">CO_NMT_reset_cmd_t</a> *reset, uint16_t timer1ms)</td></tr>
<tr class="separator:a747f27c60b64040104d511f4a18a4ca9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a898b7262ba5edd4cbab1a7ee26e9e7bc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_c_o___linux__tasks_8h.html#a898b7262ba5edd4cbab1a7ee26e9e7bc">taskMain_cbSignal</a> (void)</td></tr>
<tr class="separator:a898b7262ba5edd4cbab1a7ee26e9e7bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d742f322ef46f86e7b6d94fd42d11e4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_c_o___linux__tasks_8h.html#a4d742f322ef46f86e7b6d94fd42d11e4">CANrx_taskTmr_init</a> (int fdEpoll, long <a class="el" href="_c_o___linux__tasks_8c.html#a08295c99e459c77f070d104b0a57024b">intervalns</a>, uint16_t *<a class="el" href="_c_o___linux__tasks_8c.html#ac23667425f53852f06b73af3b480e138">maxTime</a>)</td></tr>
<tr class="separator:a4d742f322ef46f86e7b6d94fd42d11e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bb847dbce1752067f0ae7a5adb1cc42"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_c_o___linux__tasks_8h.html#a6bb847dbce1752067f0ae7a5adb1cc42">CANrx_taskTmr_close</a> (void)</td></tr>
<tr class="separator:a6bb847dbce1752067f0ae7a5adb1cc42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d48a4cae42267797d7f5dab11859710"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_c_o__driver_8h.html#a9d1c1dc81799d49e2348821d6a8cac63">bool_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_c_o___linux__tasks_8h.html#a0d48a4cae42267797d7f5dab11859710">CANrx_taskTmr_process</a> (int fd)</td></tr>
<tr class="separator:a0d48a4cae42267797d7f5dab11859710"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b9f1f67d3eb38514a09e902e832af87"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_c_o___linux__tasks_8h.html#a9b9f1f67d3eb38514a09e902e832af87">CANrx_lockCbSync</a> (<a class="el" href="_c_o__driver_8h.html#a9d1c1dc81799d49e2348821d6a8cac63">bool_t</a> syncReceived)</td></tr>
<tr class="separator:a9b9f1f67d3eb38514a09e902e832af87"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a9b9f1f67d3eb38514a09e902e832af87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b9f1f67d3eb38514a09e902e832af87">&#9670;&nbsp;</a></span>CANrx_lockCbSync()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CANrx_lockCbSync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_c_o__driver_8h.html#a9d1c1dc81799d49e2348821d6a8cac63">bool_t</a>&#160;</td>
          <td class="paramname"><em>syncReceived</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Disable CAN receive thread temporary.</p>
<p>Function is called at SYNC message on CAN bus. It disables CAN receive thread until RPDOs are processed. </p>

</div>
</div>
<a id="a6bb847dbce1752067f0ae7a5adb1cc42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bb847dbce1752067f0ae7a5adb1cc42">&#9670;&nbsp;</a></span>CANrx_taskTmr_close()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CANrx_taskTmr_close </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Cleanup realtime task. </p>

</div>
</div>
<a id="a4d742f322ef46f86e7b6d94fd42d11e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d742f322ef46f86e7b6d94fd42d11e4">&#9670;&nbsp;</a></span>CANrx_taskTmr_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CANrx_taskTmr_init </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fdEpoll</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>intervalns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t *&#160;</td>
          <td class="paramname"><em>maxTime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize realtime task.</p>
<p>CANrx_taskTmr is realtime task for CANopenNode processing. It is nonblocking and is executing on CAN message receive or periodically in 1ms (or something) intervals. Inside interval is processed CANopen SYNC message, RPDOs(inputs) and TPDOs(outputs). Between inputs and outputs can also be executed some realtime application code. CANrx_taskTmr uses Linux epoll, CAN socket form <a class="el" href="_c_o__driver_8c.html">CO_driver.c</a> and timerfd for interval.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fdEpoll</td><td>File descriptor for Linux epoll API. </td></tr>
    <tr><td class="paramname">intervalns</td><td>Interval of periodic timer in nanoseconds. </td></tr>
    <tr><td class="paramname">maxTime</td><td>Pointer to variable, where longest interval will be written [in milliseconds]. If NULL, calculations won't be made. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0d48a4cae42267797d7f5dab11859710"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d48a4cae42267797d7f5dab11859710">&#9670;&nbsp;</a></span>CANrx_taskTmr_process()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_c_o__driver_8h.html#a9d1c1dc81799d49e2348821d6a8cac63">bool_t</a> CANrx_taskTmr_process </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Process realtime task.</p>
<p>Function must be called after epoll.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fd</td><td>Available file descriptor from epoll().</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True, if fd was matched. </dd></dl>

</div>
</div>
<a id="a898b7262ba5edd4cbab1a7ee26e9e7bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a898b7262ba5edd4cbab1a7ee26e9e7bc">&#9670;&nbsp;</a></span>taskMain_cbSignal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void taskMain_cbSignal </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Signal function, which triggers mainline task.</p>
<p>It is used from some CANopenNode objects as callback. </p>

</div>
</div>
<a id="a1d70d277400050a2e10a0e6ce0e2a15e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d70d277400050a2e10a0e6ce0e2a15e">&#9670;&nbsp;</a></span>taskMain_close()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void taskMain_close </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Cleanup mainline task. </p>

</div>
</div>
<a id="a3fcc21d39338b63a6e67344c57f75ec7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3fcc21d39338b63a6e67344c57f75ec7">&#9670;&nbsp;</a></span>taskMain_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void taskMain_init </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fdEpoll</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t *&#160;</td>
          <td class="paramname"><em>maxTime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize mainline task.</p>
<p>taskMain is non-realtime task for CANopenNode processing. It is nonblocking and is executing cyclically in 50 ms intervals or less if necessary. It uses Linux epoll, timerfd for interval and pipe for task triggering. This task processes <a class="el" href="group___c_o___c_a_nopen.html#gae3628f88850473dc2e51c337d8cbb881">CO_process()</a> function from <a class="el" href="_c_a_nopen_8c.html">CANopen.c</a> file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fdEpoll</td><td>File descriptor for Linux epoll API. </td></tr>
    <tr><td class="paramname">maxTime</td><td>Pointer to variable, where longest interval will be written [in milliseconds]. If NULL, calculations won't be made. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a747f27c60b64040104d511f4a18a4ca9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a747f27c60b64040104d511f4a18a4ca9">&#9670;&nbsp;</a></span>taskMain_process()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_c_o__driver_8h.html#a9d1c1dc81799d49e2348821d6a8cac63">bool_t</a> taskMain_process </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group___c_o___n_m_t___heartbeat.html#gaf42f056a571b8e17a2d74428d1a49674">CO_NMT_reset_cmd_t</a> *&#160;</td>
          <td class="paramname"><em>reset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>timer1ms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Process mainline task.</p>
<p>Function must be called after epoll.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fd</td><td>Available file descriptor from epoll(). </td></tr>
    <tr><td class="paramname">reset</td><td>return value from <a class="el" href="group___c_o___c_a_nopen.html#gae3628f88850473dc2e51c337d8cbb881">CO_process()</a> function. </td></tr>
    <tr><td class="paramname">timer1ms</td><td>variable, which must increment each millisecond.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True, if fd was matched. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
